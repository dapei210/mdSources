[OpenLdap](https://segmentfault.com/a/1190000014683418)


### 基础知识
#### 域
域(Domain)是Windows网络中独立运行的单位，域之间相互访问则需要建立信任关系。
信任关系是连接在域与域之间的桥梁。当一个域与其他域建立了信任关系后，2个域之间不但可以按需要相互进行管理，还可以跨网分配文件和打印机等设备资源，使不同的域之间实现网络资源的共享与管理，以及相互通信和数据传输。

不过在“域”模式下，至少有一台服务器负责每一台联入网络的电脑和用户的验证工作，相当于一个单位的门卫一样，称为“域控制器（Domain Controller，简写为DC）

域控制器中包含了由这个域的账户、密码、属于这个域的计算机等信息构成的数据库。当电脑联入网络时，域控制器首先要鉴别这台电脑是否是属于这个域的，用户使用的登录账号是否存在、密码是否正确。如果以上信息有一样不正确，那么域控制器就会拒绝这个用户从这台电脑登录。不能登录，用户就不能访问服务器上有权限保护的资源，他只能以对等网用户的方式访问Windows共享出来的资源，这样就在一定程度上保护了网络上的资源

#### 域和组的区别
域和工作组适用的环境不同，域一般是用在比较大的网络里，工作组则较小，在一个域中需要一台类似服务器的计算机，叫域控服务器，其他电脑如果想互相访问首先都是经过它的，但是工作组则不同，在一个工作组里的所有计算机都是对等的，也就是没有服务器和客户机之分的，但是和域一样，如果一台计算机想访问其他计算机的话首先也要找到这个组中的一台类似组控服务器，组控服务器不是固定的，以选举的方式实现，它存储着这个组的相关信息，找到这台计算机后得到组的信息然后访问

#### 域的优势
1. 方便管理,权限管理比较集中,管理人员可以较好的管理计算机资源。

2. 安全性高,有利于企业的一些保密资料的管理,比如一个文件只能让某一个人或指定人员看,但不可以删/改/移等。

3. 方便对用户操作进行权限设置,可以分发,指派软件等,实现网络内的软件一起安装。

4. 很多服务必须建立在域环境中,对管理员来说有好处:统一管理,方便在MS 软件方面集成,如ISA EXCHANGE(邮件服务器)、ISA SERVER(上网的各种设置与管理)等。

5. 使用漫游账户和文件夹重定向技术,个人账户的工作文件及数据等可以存储在服务器上,统一进行备份、管理,用户的数据更加安全、有保障。

6. 方便用户使用各种资源。

7. SMS(System Management Server)能够分发应用程序、系统补丁等,用户可以选择安装,也可以由系统管理员指派自动安装。并能集中管理系统补丁(如Windows Updates),不需每台客户端服务器都下载同样的补丁,从而节省大量网络带宽。

8. 资源共享：用户和管理员可以不知道他们所需要的对象的确切名称,但是他们可能知道这个对象的一个或多个属性,他们可以通过查找对象的部分属性在域中得到一个所有已知属性相匹配的对象列表,通过域使得基于一个或者多个对象属性来查找一个对象变得可能。

9. 管理
A、域控制器集中管理用户对网络的访问,如登录、验证、访问目录和共享资源。为了简化管理,所有域中的域控制器都是平等的,你可以在任何域控制器上进行修改,这种更新可以复制到域中所有的其他域控制器上。
B、域的实施通过提供对网络上所有对象的单点管理进一步简化了管理。因为域控制器提供了对网络上所有资源的单点登录,管理远可以登录到一台计算机来管理网络中任何计算机上的管理对象。在NT网络中,当用户一次登陆一个域服务器后,就可以访问该域中已经开放的全部资源,而无需对同一域进行多次登陆。但在需要共享不同域中的服务时,对每个域都必须要登陆一次,否则无法访问未登陆域服务器中的资源或无法获得未登陆域的服务。

10. 可扩展性：在活动目录中,目录通过将目录组织成几个部分存储信息从而允许存储大量的对象。因此,目录可以随着组织的增长而一同扩展,允许用户从一个具有几百个对象的小的安装环境发展成拥有几百万对象的大型安装环境。

11. 安全性：域为用户提供了单一的登录过程来访问网络资源,如所有他们具有权限的文件、打印机和应用程序资源。也就是说,用户可以登录到一台计算机来使用网络上另外一台计算机上的资源,只要用户具有对资源的合适权限。域通过对用户权限合适的划分,确定了只有对特定资源有合法权限的用户才能使用该资源,从而保障了资源使用的合法性和安全性。

12. 可冗余性：每个域控制器保存和维护目录的一个副本。在域中,你创建的每一个用户帐号都会对应目录的一个记录。当用户登录到域中的计算机时,域控制器将按照目录检查用户名、口令、登录限制以验证用户。当存在多个域控制器时,他们会定期的相互复制目录信息,域控制器间的数据复制,促使用户信息发生改变时(比如用户修改了口令),可以迅速的复制到其他的域控制器上,这样当一台域控制器出现故障时,用户仍然可以通过其他的域控制进行登录,保障了网络的顺利运行。


#### AD域管理功能
1. AD域管理：通过批量创建和编辑用户帐户，指派管理权限等，简化Windows AD域的管理。

2. 批量管理域用户：使用CSV文件批量导入用户、编辑用户属性、重置密码、批量迁移用户和用户对象。

3. 批量创建域用户：通过导入CSV文件，批量创建用户，包含Exchange邮箱、终端服务等所有属性，指派到组。

4. 批量编辑域用户：批量重置密码、解锁用户、迁移用户、删除/启用/禁用用户、添加到组或从组中移除、修改用户属性等。

5. 管理不活跃/禁用的用户帐户：通过生成不活域/禁用的用户帐户列表，轻松删除、启用或迁移帐户，达到清理AD域的目的。

6. AD域密码管理：重置多个用户帐户的密码、配置密码策略、启用/禁用密码过期的用户。

7. 手机App：通过手机App执行重置密码、启用、禁用、解锁以及删除用户帐户等操作。

8. AD域计算机管理：批量创建计算机、启用、禁用和迁移计算机，修改计算机属性和所属组。

9. 终端服务管理：批量编辑终端服务主文件夹、路径、启动程序、会话时间和远程设置。

### LDAP
该协议用来访问目录数据库的，在计算机域中，目录服务数据库存储整个域内所有的计算机、用户等信息。目录服务=服务数据库+访问协议。
目录服务数据库本质上是一个数据库， 用来存储数据的，主要有以下两个特点：
1. 树状组织结构，类似文件目录
2. 为查询、浏览和搜索而优化的数据库，即LDAP的读性能特别强，但是写性能差，而且还不支持事务处理、回滚等复杂功能。

#### LDAP中的DN,CN,OU,DC
LDAP是建立在"条目"(entries)的基础上，具有一个全局唯一的DN(可区分名称)，每个条目具有一个类型和一个或多个值，每个对象都有唯一的名称，如"uid=tom, ou=marker,dc=example,dc=com"

UID(User ID): 用户ID

CN(Common Name):公共名称，相当于用户名

OU(Organizational Unit):组织单位，类似于文件系统中的子目录

DC(Domain Component):域名的部分，其格式将完整的域名分成几个部分，如example.com-----dc=example,dc=com

![LDAP树形结构](ldap树形结构.png)

三者都是LDAP连接服务器端字符串的区分名DN(Distinguished Name),LDAP连接服务器的连接字符串格式为：ldap://servername/DN

### OpenLdap和AD
Microsoft Active Directory（AD）是一种目录服务，可将用户和设备帐户数据存储在中央位置，用于基于 Windows 的网络、设备、应用程序和文件实现访问。



